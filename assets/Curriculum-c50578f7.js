import{_ as y,a1 as E,c as g,k as S,O as r,P as w,N as M,r as C,a as l,d as t,g as I,F as D,e as L,f as k,t as B,b,q as O,o as u,J as U,p as N,i as T}from"./index-21a304d0.js";const V={setup(){const{buildCourseMap:n,saveCourseOrder:s}=E();let p=g(()=>r.builtCourse);return S(()=>{n()}),{BUILT_COURSE:p,editing:g(()=>r.editing),buildCourse(){n()},handleDroppedChapter(e,o,i){if(console.log("dropping",{placement:e,i:o,chapter:i}),i.chapterId)return;o=e=="before"?o:o+1;const c=r.builtCourse.chapters.findIndex(_=>_.id==i.id);o<c?(r.builtCourse.chapters.splice(c,1),r.builtCourse.chapters.splice(o,0,i)):(r.builtCourse.chapters.splice(o,0,i),r.builtCourse.chapters.splice(c,1))},async createChapter(e){const o=await w.prompt("Chapter Title");if(!o)return;const i=await M.createChapter({title:o,courseId:p.value.id});r.builtCourse.chapters.splice(e,0,i),s(r.builtCourse)},saveChanges(){s(r.builtCourse)},clearEditing(){r.editing=null}}}},d=n=>(N("data-v-42d2b731"),n=n(),T(),n),R={class:"curriculum-manager rounded"},F={class:"fs-3"},P=d(()=>t("span",null,"Curriculum Manager",-1)),q=d(()=>t("i",{class:"mdi mdi-refresh"},null,-1)),z=[q],A=d(()=>t("i",{class:"mdi mdi-cloud-upload"},null,-1)),J={key:0,class:"my-3"},j=d(()=>t("div",{class:"fs-5"},"Chapters",-1)),G={class:"mt-2"},H={class:"chapter rounded border p-3 mt-2"},K=["onClick"],Q=d(()=>t("div",{class:"text-white"},[I(" Insert Chapter "),t("i",{class:"mdi mdi-arrow-down-right"})],-1)),W=[Q],X=d(()=>t("hr",null,null,-1)),Y={class:"offcanvas-header"},Z={class:"offcanvas-title",id:"curriculum-editor-Label"},$={key:0,class:"offcanvas-body"};function ee(n,s,p,e,o,i){var m,f;const c=C("ChapterEditor"),_=C("Droppable"),x=C("CurriculumEditor");return u(),l("div",R,[t("div",F,[P,t("button",{class:"btn",onClick:s[0]||(s[0]=(...a)=>e.buildCourse&&e.buildCourse(...a)),title:"refresh"},z),t("button",{class:"btn",onClick:s[1]||(s[1]=(...a)=>e.saveChanges&&e.saveChanges(...a)),title:"Save Order Changes"},[A,I(" Save Changes ")])]),e.BUILT_COURSE?(u(),l("section",J,[j,t("div",G,[t("button",{class:"btn p-0 clickable-inform border-inform lift-4 w-100",onClick:s[2]||(s[2]=a=>e.createChapter(0))}," Add Chapter "),(u(!0),l(D,null,L(e.BUILT_COURSE.chapters,(a,h)=>(u(),l("div",{key:a.id},[t("div",H,[b(c,{chapter:a,index:h},null,8,["chapter","index"])]),b(_,{dropMessage:"Move Chapter",onDropped:v=>e.handleDroppedChapter("after",h,v)},{default:U(()=>[t("button",{class:"btn hover-bg-inform-10 border-inform drop-4 ms-1 py-0 on-hover insert-chapter",onClick:v=>e.createChapter(h+1)},W,8,K)]),_:2},1032,["onDropped"])]))),128))]),X])):k("",!0),t("div",{class:O(["offcanvas bg-page drop-3 offcanvas-start",{isLesson:(m=e.editing)==null?void 0:m.chapterId}]),"data-bs-backdrop":"static",tabindex:"-1",id:"curriculum-editor","aria-labelledby":"curriculum-editor-Label"},[t("div",Y,[t("h5",Z,"Editing "+B((f=e.editing)==null?void 0:f.title),1),t("button",{type:"button",class:"btn-close",onClick:s[3]||(s[3]=(...a)=>e.clearEditing&&e.clearEditing(...a)),"data-bs-dismiss":"offcanvas","aria-label":"Close"})]),e.editing?(u(),l("div",$,[b(x,{editing:e.editing},null,8,["editing"])])):k("",!0)],2)])}const se=y(V,[["render",ee],["__scopeId","data-v-42d2b731"]]);export{se as default};
