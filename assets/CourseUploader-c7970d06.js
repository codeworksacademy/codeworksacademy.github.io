import{_ as F,h as m,Y as I,o as l,a as r,d as t,C as M,D as T,Q as A,k as d,F as D,q as B,K as E,t as p,G as N,Z as P,v as $,p as L,g as q,$ as V,N as G,M as z,L as K,P as O}from"./index-f56e3f4a.js";const y=_=>(L("data-v-0f66c75b"),_=_(),q(),_),Q={class:"bg-page drop-2 p-4 rounded"},R=y(()=>t("div",{class:"fs-3"},"Bulk Uploader",-1)),Y={class:"mb-3"},Z=y(()=>t("label",{for:"chapterTitle"},"Chapter Title",-1)),j=["onSubmit"],H={class:"input-group mb-3"},J=["disabled"],W={class:"list-group-item border-0 border-bottom square bg-page drop-3"},X={key:0,class:"d-flex gap-3"},ee={class:"fx"},te={class:"text-muted"},ae={key:0},se={class:"progress rounded-0 w-100",style:{height:"25px"}},oe={class:"fx ms-auto text-end"},le=["src","onClick"],re={__name:"CourseUploader",setup(_){const i=m([]),h=m({}),n=m({title:""}),u=m(!1);function C(a){const s=V();return s.setFile(a),h.value[a.name]=U(a.name),s}async function k(a){var e;const s=a.target;if((e=s.files)!=null&&e.length)try{i.value=Array.from(s.files).map(C)}catch(c){E.error("[FILE_UPLOADER]",c)}}async function x(){var e;if(u.value)return;const a=G.course.id;u.value=!0;const s=await z.createChapter({courseId:a,title:n.value.title});for(const{uploadToPrivateContainer:c,uploadThumbnail:v}of i.value){const o=await c();if(!(o!=null&&o.file))return;const{name:b}=o.file,f=h.value[b],S=((e=o.metadata)==null?void 0:e.duration)??0,w=await v();await K.createContent({courseId:a,chapterId:s.id,title:f,content:{videoUrl:o.url},metadata:{type:"lesson",duration:S,thumbnail:w.url||""}})}O.success("Chapter Successfully uploaded Go to Curriculum Page to continue editing","center"),g()}function g(){var a;n.value.title="",(a=i.value)==null||a.forEach(s=>s.reset()),i.value=[],h.value={},u.value=!1}I(()=>{g()});function U(a){return a.replace(/\.[^/.]+$/,"").replaceAll(/[^\w]/ig," ").replace(/^[0-9\s]+/,"").replaceAll(/\s+/ig," ").trim()}return(a,s)=>(l(),r("div",Q,[R,t("div",Y,[Z,M(t("input",{class:"form-control",type:"text","onUpdate:modelValue":s[0]||(s[0]=e=>n.value.title=e),required:"",minlength:"3",maxlength:"50",placeholder:"Enter a chapter title to bulk upload"},null,512),[[T,n.value.title]])]),n.value.title.length>3?(l(),r("form",{key:0,onSubmit:A(x,["prevent"])},[t("div",H,[t("input",{class:"uploadFile form-control",type:"file",onChange:k,multiple:"true",accept:"video/*"},null,32),i.value.length?(l(),r("button",{key:0,class:"btn btn-info input-group-addon",type:"submit",disabled:u.value},"Upload All",8,J)):d("",!0)])],40,j)):d("",!0),(l(!0),r(D,null,B(i.value,(e,c)=>{var v,o;return l(),r("div",{class:"list-group",key:e.id},[t("li",W,[e.file?(l(),r("div",X,[t("div",ee,[t("div",null,[t("span",te,p(`${c+1}`.padStart(2,"0"))+". ",1),t("strong",null,p(h.value[(v=e.file)==null?void 0:v.name]??""),1)]),u.value?(l(),r("div",ae,[t("div",se,[t("div",{class:"progress-bar progress-bar-striped bg-info progress-bar-animated",style:N({width:`${e.progress}%`})},p(e.progress??"")+"%",5)])])):d("",!0)]),t("div",oe,[t("div",null,p(e.file.name),1),t("div",null,p(P($)(((o=e.metadata)==null?void 0:o.duration)??0)),1)]),e.thumbnailUrl?(l(),r("img",{key:0,class:"thumbnail selectable",src:e.thumbnailUrl,onClick:b=>{var f;return e.loadThumbnail(Math.random()*(((f=e.metadata)==null?void 0:f.duration)||100))},title:"Change Thumbnail"},null,8,le)):d("",!0)])):d("",!0)])])}),128))]))}},ne=F(re,[["__scopeId","data-v-0f66c75b"]]);export{ne as default};
