import{_ as I,l as f,Z as F,a as l,d as t,D as M,E as T,R as A,f as d,F as D,e as E,L as B,o as r,t as p,I as N,$ as P,y as $,p as L,i as V,a0 as q,O,N as R,M as z,P as G}from"./index-15d2a217.js";const y=_=>(L("data-v-0ca37eec"),_=_(),V(),_),Z={class:"rounded"},j=y(()=>t("div",{class:"fs-3"},"Bulk Uploader",-1)),H={class:"mb-3"},J=y(()=>t("label",{for:"chapterTitle"},"Chapter Title",-1)),K=["onSubmit"],Q={class:"input-group mb-3"},W=["disabled"],X={class:"list-group-item border-0 border-bottom square bg-page drop-3"},Y={key:0,class:"d-flex gap-3"},ee={class:"fx"},te={class:"text-muted"},ae={key:0},se={class:"progress rounded-0 w-100",style:{height:"25px"}},oe={class:"fx ms-auto text-end"},le=["src","onClick"],re={__name:"CourseUploader",setup(_){const i=f([]),h=f({}),n=f({title:""}),c=f(!1);function C(a){const s=q();return s.setFile(a),h.value[a.name]=k(a.name),s}async function x(a){var e;const s=a.target;if((e=s.files)!=null&&e.length)try{i.value=Array.from(s.files).map(C)}catch(u){B.error("[FILE_UPLOADER]",u)}}async function U(){var e;if(c.value)return;const a=O.course.id;c.value=!0;const s=await R.createChapter({courseId:a,title:n.value.title});for(const{uploadToPrivateContainer:u,uploadThumbnail:v}of i.value){const o=await u();if(!(o!=null&&o.file))return;const{name:b}=o.file,m=h.value[b],S=((e=o.metadata)==null?void 0:e.duration)??0,w=await v();await z.createContent({courseId:a,chapterId:s.id,title:m,content:{videoUrl:o.url},metadata:{type:"lesson",duration:S,thumbnail:w.url||""}})}G.success("Chapter Successfully uploaded Go to Curriculum Page to continue editing","center"),g()}function g(){var a;n.value.title="",(a=i.value)==null||a.forEach(s=>s.reset()),i.value=[],h.value={},c.value=!1}F(()=>{g()});function k(a){return a.replace(/\.[^/.]+$/,"").replaceAll(/[^\w]/ig," ").replace(/^[0-9\s]+/,"").replaceAll(/\s+/ig," ").trim()}return(a,s)=>(r(),l("div",Z,[j,t("div",H,[J,M(t("input",{class:"form-control",type:"text","onUpdate:modelValue":s[0]||(s[0]=e=>n.value.title=e),required:"",minlength:"3",maxlength:"50",placeholder:"Enter a chapter title to bulk upload"},null,512),[[T,n.value.title]])]),n.value.title.length>3?(r(),l("form",{key:0,onSubmit:A(U,["prevent"])},[t("div",Q,[t("input",{class:"uploadFile form-control",type:"file",onChange:x,multiple:"true",accept:"video/*"},null,32),i.value.length?(r(),l("button",{key:0,class:"btn btn-info input-group-addon",type:"submit",disabled:c.value},"Upload All",8,W)):d("",!0)])],40,K)):d("",!0),(r(!0),l(D,null,E(i.value,(e,u)=>{var v,o;return r(),l("div",{class:"list-group",key:e.id},[t("li",X,[e.file?(r(),l("div",Y,[t("div",ee,[t("div",null,[t("span",te,p(`${u+1}`.padStart(2,"0"))+". ",1),t("strong",null,p(h.value[(v=e.file)==null?void 0:v.name]??""),1)]),c.value?(r(),l("div",ae,[t("div",se,[t("div",{class:"progress-bar progress-bar-striped bg-info progress-bar-animated",style:N({width:`${e.progress}%`})},p(e.progress??"")+"%",5)])])):d("",!0)]),t("div",oe,[t("div",null,p(e.file.name),1),t("div",null,p(P($)(((o=e.metadata)==null?void 0:o.duration)??0)),1)]),e.thumbnailUrl?(r(),l("img",{key:0,class:"thumbnail selectable",src:e.thumbnailUrl,onClick:b=>{var m;return e.loadThumbnail(Math.random()*(((m=e.metadata)==null?void 0:m.duration)||100))},title:"Change Thumbnail"},null,8,le)):d("",!0)])):d("",!0)])])}),128))]))}},ne=I(re,[["__scopeId","data-v-0ca37eec"]]);export{ne as default};
